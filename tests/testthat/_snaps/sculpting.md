# calculate_ice_data and generate_ice_data works as expected

    Code
      as.data.frame(ice_data)
    Output
             x         ice ice_centered line_id
      1   21.0 187.1071489    -2.491282       1
      2   21.0 187.1071489    -2.491282       1
      3   22.8 182.1759516    -7.422479       1
      4   21.4 186.0113272    -3.587104       1
      5   18.7 193.4081232     3.809692       1
      6   18.1 195.0518556     5.453425       1
      7   14.3 205.4621610    15.863730       1
      8   24.4 177.7926651   -11.805766       1
      9   22.8 182.1759516    -7.422479       1
      10  19.2 192.0383462     2.439915       1
      11  17.8 195.8737218     6.275291       1
      12  16.4 199.7090975    10.110667       1
      13  17.3 197.2434989     7.645068       1
      14  15.2 202.9965624    13.398132       1
      15  10.4 216.1464218    26.547991       1
      16  10.4 216.1464218    26.547991       1
      17  14.7 204.3663394    14.767909       1
      18  32.4 155.8762327   -33.722198       1
      19  30.4 161.3553408   -28.243090       1
      20  33.9 151.7669016   -37.831529       1
      21  21.5 185.7373718    -3.861059       1
      22  15.5 202.1746961    12.576265       1
      23  15.2 202.9965624    13.398132       1
      24  13.3 208.2017151    18.603284       1
      25  19.2 192.0383462     2.439915       1
      26  27.3 169.8479583   -19.750472       1
      27  26.0 173.4093786   -16.189052       1
      28  30.4 161.3553408   -28.243090       1
      29  15.8 201.3528299    11.754399       1
      30  19.7 190.6685691     1.070138       1
      31  15.0 203.5444732    13.946042       1
      32  21.4 186.0113272    -3.587104       1
      33  21.0  56.3541331    -2.491282       2
      34  21.0  56.3541331    -2.491282       2
      35  22.8  51.4229358    -7.422479       2
      36  21.4  55.2583115    -3.587104       2
      37  18.7  62.6551074     3.809692       2
      38  18.1  64.2988398     5.453425       2
      39  14.3  74.7091452    15.863730       2
      40  24.4  47.0396493   -11.805766       2
      41  22.8  51.4229358    -7.422479       2
      42  19.2  61.2853304     2.439915       2
      43  17.8  65.1207060     6.275291       2
      44  16.4  68.9560817    10.110667       2
      45  17.3  66.4904831     7.645068       2
      46  15.2  72.2435466    13.398132       2
      47  10.4  85.3934060    26.547991       2
      48  10.4  85.3934060    26.547991       2
      49  14.7  73.6133236    14.767909       2
      50  32.4  25.1232169   -33.722198       2
      51  30.4  30.6023250   -28.243090       2
      52  33.9  21.0138858   -37.831529       2
      53  21.5  54.9843561    -3.861059       2
      54  15.5  71.4216804    12.576265       2
      55  15.2  72.2435466    13.398132       2
      56  13.3  77.4486993    18.603284       2
      57  19.2  61.2853304     2.439915       2
      58  27.3  39.0949426   -19.750472       2
      59  26.0  42.6563628   -16.189052       2
      60  30.4  30.6023250   -28.243090       2
      61  15.8  70.5998141    11.754399       2
      62  19.7  59.9155533     1.070138       2
      63  15.0  72.7914574    13.946042       2
      64  21.4  55.2583115    -3.587104       2
      65  21.0 143.4907976    -2.491282       3
      66  21.0 143.4907976    -2.491282       3
      67  22.8 138.5596003    -7.422479       3
      68  21.4 142.3949760    -3.587104       3
      69  18.7 149.7917719     3.809692       3
      70  18.1 151.4355044     5.453425       3
      71  14.3 161.8458098    15.863730       3
      72  24.4 134.1763138   -11.805766       3
      73  22.8 138.5596003    -7.422479       3
      74  19.2 148.4219949     2.439915       3
      75  17.8 152.2573706     6.275291       3
      76  16.4 156.0927462    10.110667       3
      77  17.3 153.6271476     7.645068       3
      78  15.2 159.3802111    13.398132       3
      79  10.4 172.5300706    26.547991       3
      80  10.4 172.5300706    26.547991       3
      81  14.7 160.7499881    14.767909       3
      82  32.4 112.2598814   -33.722198       3
      83  30.4 117.7389895   -28.243090       3
      84  33.9 108.1505504   -37.831529       3
      85  21.5 142.1210206    -3.861059       3
      86  15.5 158.5583449    12.576265       3
      87  15.2 159.3802111    13.398132       3
      88  13.3 164.5853638    18.603284       3
      89  19.2 148.4219949     2.439915       3
      90  27.3 126.2316071   -19.750472       3
      91  26.0 129.7930274   -16.189052       3
      92  30.4 117.7389895   -28.243090       3
      93  15.8 157.7364787    11.754399       3
      94  19.7 147.0522179     1.070138       3
      95  15.0 159.9281219    13.946042       3
      96  21.4 142.3949760    -3.587104       3
      97  21.0  52.1832037    -2.491282       4
      98  21.0  52.1832037    -2.491282       4
      99  22.8  47.2520064    -7.422479       4
      100 21.4  51.0873821    -3.587104       4
      101 18.7  58.4841780     3.809692       4
      102 18.1  60.1279104     5.453425       4
      103 14.3  70.5382158    15.863730       4
      104 24.4  42.8687199   -11.805766       4
      105 22.8  47.2520064    -7.422479       4
      106 19.2  57.1144010     2.439915       4
      107 17.8  60.9497766     6.275291       4
      108 16.4  64.7851523    10.110667       4
      109 17.3  62.3195537     7.645068       4
      110 15.2  68.0726172    13.398132       4
      111 10.4  81.2224766    26.547991       4
      112 10.4  81.2224766    26.547991       4
      113 14.7  69.4423942    14.767909       4
      114 32.4  20.9522875   -33.722198       4
      115 30.4  26.4313956   -28.243090       4
      116 33.9  16.8429564   -37.831529       4
      117 21.5  50.8134267    -3.861059       4
      118 15.5  67.2507510    12.576265       4
      119 15.2  68.0726172    13.398132       4
      120 13.3  73.2777699    18.603284       4
      121 19.2  57.1144010     2.439915       4
      122 27.3  34.9240132   -19.750472       4
      123 26.0  38.4854334   -16.189052       4
      124 30.4  26.4313956   -28.243090       4
      125 15.8  66.4288847    11.754399       4
      126 19.7  55.7446239     1.070138       4
      127 15.0  68.6205280    13.946042       4
      128 21.4  51.0873821    -3.587104       4
      129 21.0   8.4216457    -2.491282       5
      130 21.0   8.4216457    -2.491282       5
      131 22.8   3.4904484    -7.422479       5
      132 21.4   7.3258240    -3.587104       5
      133 18.7  14.7226200     3.809692       5
      134 18.1  16.3663524     5.453425       5
      135 14.3  26.7766578    15.863730       5
      136 24.4  -0.8928381   -11.805766       5
      137 22.8   3.4904484    -7.422479       5
      138 19.2  13.3528430     2.439915       5
      139 17.8  17.1882186     6.275291       5
      140 16.4  21.0235943    10.110667       5
      141 17.3  18.5579957     7.645068       5
      142 15.2  24.3110592    13.398132       5
      143 10.4  37.4609186    26.547991       5
      144 10.4  37.4609186    26.547991       5
      145 14.7  25.6808362    14.767909       5
      146 32.4 -22.8092705   -33.722198       5
      147 30.4 -17.3301624   -28.243090       5
      148 33.9 -26.9186016   -37.831529       5
      149 21.5   7.0518686    -3.861059       5
      150 15.5  23.4891929    12.576265       5
      151 15.2  24.3110592    13.398132       5
      152 13.3  29.5162119    18.603284       5
      153 19.2  13.3528430     2.439915       5
      154 27.3  -8.8375449   -19.750472       5
      155 26.0  -5.2761246   -16.189052       5
      156 30.4 -17.3301624   -28.243090       5
      157 15.8  22.6673267    11.754399       5
      158 19.7  11.9830659     1.070138       5
      159 15.0  24.8589700    13.946042       5
      160 21.4   7.3258240    -3.587104       5

---

    Code
      as.data.frame(ice_data)
    Output
          x        ice ice_centered line_id
      1   6 125.092273    -34.41584       1
      2   6 125.092273    -34.41584       1
      3   4 140.006992    -19.50112       1
      4   6 125.092273    -34.41584       1
      5   8 192.038346     32.53023       1
      6   6 125.092273    -34.41584       1
      7   8 192.038346     32.53023       1
      8   4 140.006992    -19.50112       1
      9   4 140.006992    -19.50112       1
      10  6 125.092273    -34.41584       1
      11  6 125.092273    -34.41584       1
      12  8 192.038346     32.53023       1
      13  8 192.038346     32.53023       1
      14  8 192.038346     32.53023       1
      15  8 192.038346     32.53023       1
      16  8 192.038346     32.53023       1
      17  8 192.038346     32.53023       1
      18  4 140.006992    -19.50112       1
      19  4 140.006992    -19.50112       1
      20  4 140.006992    -19.50112       1
      21  4 140.006992    -19.50112       1
      22  8 192.038346     32.53023       1
      23  8 192.038346     32.53023       1
      24  8 192.038346     32.53023       1
      25  8 192.038346     32.53023       1
      26  4 140.006992    -19.50112       1
      27  4 140.006992    -19.50112       1
      28  4 140.006992    -19.50112       1
      29  8 192.038346     32.53023       1
      30  6 125.092273    -34.41584       1
      31  8 192.038346     32.53023       1
      32  4 140.006992    -19.50112       1
      33  6  55.258311    -34.41584       2
      34  6  55.258311    -34.41584       2
      35  4  70.173031    -19.50112       2
      36  6  55.258311    -34.41584       2
      37  8 122.204384     32.53023       2
      38  6  55.258311    -34.41584       2
      39  8 122.204384     32.53023       2
      40  4  70.173031    -19.50112       2
      41  4  70.173031    -19.50112       2
      42  6  55.258311    -34.41584       2
      43  6  55.258311    -34.41584       2
      44  8 122.204384     32.53023       2
      45  8 122.204384     32.53023       2
      46  8 122.204384     32.53023       2
      47  8 122.204384     32.53023       2
      48  8 122.204384     32.53023       2
      49  8 122.204384     32.53023       2
      50  4  70.173031    -19.50112       2
      51  4  70.173031    -19.50112       2
      52  4  70.173031    -19.50112       2
      53  4  70.173031    -19.50112       2
      54  8 122.204384     32.53023       2
      55  8 122.204384     32.53023       2
      56  8 122.204384     32.53023       2
      57  8 122.204384     32.53023       2
      58  4  70.173031    -19.50112       2
      59  4  70.173031    -19.50112       2
      60  4  70.173031    -19.50112       2
      61  8 122.204384     32.53023       2
      62  6  55.258311    -34.41584       2
      63  8 122.204384     32.53023       2
      64  4  70.173031    -19.50112       2
      65  6  94.899737    -34.41584       3
      66  6  94.899737    -34.41584       3
      67  4 109.814456    -19.50112       3
      68  6  94.899737    -34.41584       3
      69  8 161.845810     32.53023       3
      70  6  94.899737    -34.41584       3
      71  8 161.845810     32.53023       3
      72  4 109.814456    -19.50112       3
      73  4 109.814456    -19.50112       3
      74  6  94.899737    -34.41584       3
      75  6  94.899737    -34.41584       3
      76  8 161.845810     32.53023       3
      77  8 161.845810     32.53023       3
      78  8 161.845810     32.53023       3
      79  8 161.845810     32.53023       3
      80  8 161.845810     32.53023       3
      81  8 161.845810     32.53023       3
      82  4 109.814456    -19.50112       3
      83  4 109.814456    -19.50112       3
      84  4 109.814456    -19.50112       3
      85  4 109.814456    -19.50112       3
      86  8 161.845810     32.53023       3
      87  8 161.845810     32.53023       3
      88  8 161.845810     32.53023       3
      89  8 161.845810     32.53023       3
      90  4 109.814456    -19.50112       3
      91  4 109.814456    -19.50112       3
      92  4 109.814456    -19.50112       3
      93  8 161.845810     32.53023       3
      94  6  94.899737    -34.41584       3
      95  8 161.845810     32.53023       3
      96  4 109.814456    -19.50112       3
      97  6  52.183204    -34.41584       4
      98  6  52.183204    -34.41584       4
      99  4  67.097923    -19.50112       4
      100 6  52.183204    -34.41584       4
      101 8 119.129277     32.53023       4
      102 6  52.183204    -34.41584       4
      103 8 119.129277     32.53023       4
      104 4  67.097923    -19.50112       4
      105 4  67.097923    -19.50112       4
      106 6  52.183204    -34.41584       4
      107 6  52.183204    -34.41584       4
      108 8 119.129277     32.53023       4
      109 8 119.129277     32.53023       4
      110 8 119.129277     32.53023       4
      111 8 119.129277     32.53023       4
      112 8 119.129277     32.53023       4
      113 8 119.129277     32.53023       4
      114 4  67.097923    -19.50112       4
      115 4  67.097923    -19.50112       4
      116 4  67.097923    -19.50112       4
      117 4  67.097923    -19.50112       4
      118 8 119.129277     32.53023       4
      119 8 119.129277     32.53023       4
      120 8 119.129277     32.53023       4
      121 8 119.129277     32.53023       4
      122 4  67.097923    -19.50112       4
      123 4  67.097923    -19.50112       4
      124 4  67.097923    -19.50112       4
      125 8 119.129277     32.53023       4
      126 6  52.183204    -34.41584       4
      127 8 119.129277     32.53023       4
      128 4  67.097923    -19.50112       4
      129 6   8.421646    -34.41584       5
      130 6   8.421646    -34.41584       5
      131 4  23.336365    -19.50112       5
      132 6   8.421646    -34.41584       5
      133 8  75.367719     32.53023       5
      134 6   8.421646    -34.41584       5
      135 8  75.367719     32.53023       5
      136 4  23.336365    -19.50112       5
      137 4  23.336365    -19.50112       5
      138 6   8.421646    -34.41584       5
      139 6   8.421646    -34.41584       5
      140 8  75.367719     32.53023       5
      141 8  75.367719     32.53023       5
      142 8  75.367719     32.53023       5
      143 8  75.367719     32.53023       5
      144 8  75.367719     32.53023       5
      145 8  75.367719     32.53023       5
      146 4  23.336365    -19.50112       5
      147 4  23.336365    -19.50112       5
      148 4  23.336365    -19.50112       5
      149 4  23.336365    -19.50112       5
      150 8  75.367719     32.53023       5
      151 8  75.367719     32.53023       5
      152 8  75.367719     32.53023       5
      153 8  75.367719     32.53023       5
      154 4  23.336365    -19.50112       5
      155 4  23.336365    -19.50112       5
      156 4  23.336365    -19.50112       5
      157 8  75.367719     32.53023       5
      158 6   8.421646    -34.41584       5
      159 8  75.367719     32.53023       5
      160 4  23.336365    -19.50112       5

# calculate_pdp_data and generate_pdp_data works as expected

    Code
      as.data.frame(pdp_data[, .(x, pdp_centered)])
    Output
            x pdp_centered
      1  21.0    -2.491282
      2  22.8    -7.422479
      3  21.4    -3.587104
      4  18.7     3.809692
      5  18.1     5.453425
      6  14.3    15.863730
      7  24.4   -11.805766
      8  19.2     2.439915
      9  17.8     6.275291
      10 16.4    10.110667
      11 17.3     7.645068
      12 15.2    13.398132
      13 10.4    26.547991
      14 14.7    14.767909
      15 32.4   -33.722198
      16 30.4   -28.243090
      17 33.9   -37.831529
      18 21.5    -3.861059
      19 15.5    12.576265
      20 13.3    18.603284
      21 27.3   -19.750472
      22 26.0   -16.189052
      23 15.8    11.754399
      24 19.7     1.070138
      25 15.0    13.946042

---

    Code
      as.data.frame(pdp_data[, .(x, pdp_centered)])
    Output
        x pdp_centered
      1 6    -34.41584
      2 4    -19.50112
      3 8     32.53023

# sculpt_rough works as expected

    Code
      rs$mpg$subsets
    Output
        cyl  disp drat    wt  qsec vs am gear carb
      1   4 360.0 4.11 3.845 17.05  1  0    5    4
      2   4 160.0 3.85 5.345 16.46  1  0    5    2
      3   4 146.7 3.54 2.140 17.42  1  1    5    1
      4   8 275.8 4.08 2.140 17.42  0  0    3    2
      5   4  95.1 3.70 2.200 17.98  1  1    5    4

---

    Code
      rs$mpg$ice_centered
    Output
      $`1`
       [1]  -2.421766   6.344807   2.509432  26.617507   6.344807   2.509432
       [7]  -7.352963  -3.791543   1.139654  15.933246  13.467648 -28.173574
      [13]  -7.352963   5.522941 -19.680956  26.617507  -3.791543  10.180183
      [19]  26.617507 -19.680956   3.879209  -3.517587 -16.119536  -7.352963
      [25]  12.645781 -28.173574 -16.119536   2.509432  -3.791543 -19.680956
      [31] -19.680956 -28.173574  14.837425 -19.680956  12.645781  18.672800
      [37] -28.173574   7.714584  26.617507  13.467648   6.344807  12.645781
      [43]  13.467648 -33.652682  26.617507  -3.517587   2.509432   2.509432
      [49]   2.509432  -3.517587
      
      $`2`
       [1]  -2.421766   6.344807   2.509432  26.617507   6.344807   2.509432
       [7]  -7.352963  -3.791543   1.139654  15.933246  13.467648 -28.173574
      [13]  -7.352963   5.522941 -19.680956  26.617507  -3.791543  10.180183
      [19]  26.617507 -19.680956   3.879209  -3.517587 -16.119536  -7.352963
      [25]  12.645781 -28.173574 -16.119536   2.509432  -3.791543 -19.680956
      [31] -19.680956 -28.173574  14.837425 -19.680956  12.645781  18.672800
      [37] -28.173574   7.714584  26.617507  13.467648   6.344807  12.645781
      [43]  13.467648 -33.652682  26.617507  -3.517587   2.509432   2.509432
      [49]   2.509432  -3.517587
      
      $`3`
       [1]  -2.421766   6.344807   2.509432  26.617507   6.344807   2.509432
       [7]  -7.352963  -3.791543   1.139654  15.933246  13.467648 -28.173574
      [13]  -7.352963   5.522941 -19.680956  26.617507  -3.791543  10.180183
      [19]  26.617507 -19.680956   3.879209  -3.517587 -16.119536  -7.352963
      [25]  12.645781 -28.173574 -16.119536   2.509432  -3.791543 -19.680956
      [31] -19.680956 -28.173574  14.837425 -19.680956  12.645781  18.672800
      [37] -28.173574   7.714584  26.617507  13.467648   6.344807  12.645781
      [43]  13.467648 -33.652682  26.617507  -3.517587   2.509432   2.509432
      [49]   2.509432  -3.517587
      
      $`4`
       [1]  -2.421766   6.344807   2.509432  26.617507   6.344807   2.509432
       [7]  -7.352963  -3.791543   1.139654  15.933246  13.467648 -28.173574
      [13]  -7.352963   5.522941 -19.680956  26.617507  -3.791543  10.180183
      [19]  26.617507 -19.680956   3.879209  -3.517587 -16.119536  -7.352963
      [25]  12.645781 -28.173574 -16.119536   2.509432  -3.791543 -19.680956
      [31] -19.680956 -28.173574  14.837425 -19.680956  12.645781  18.672800
      [37] -28.173574   7.714584  26.617507  13.467648   6.344807  12.645781
      [43]  13.467648 -33.652682  26.617507  -3.517587   2.509432   2.509432
      [49]   2.509432  -3.517587
      
      $`5`
       [1]  -2.421766   6.344807   2.509432  26.617507   6.344807   2.509432
       [7]  -7.352963  -3.791543   1.139654  15.933246  13.467648 -28.173574
      [13]  -7.352963   5.522941 -19.680956  26.617507  -3.791543  10.180183
      [19]  26.617507 -19.680956   3.879209  -3.517587 -16.119536  -7.352963
      [25]  12.645781 -28.173574 -16.119536   2.509432  -3.791543 -19.680956
      [31] -19.680956 -28.173574  14.837425 -19.680956  12.645781  18.672800
      [37] -28.173574   7.714584  26.617507  13.467648   6.344807  12.645781
      [43]  13.467648 -33.652682  26.617507  -3.517587   2.509432   2.509432
      [49]   2.509432  -3.517587
      

---

    Code
      rs$mpg$predict(c(15, NA, -5, 1e+05))
    Output
      [1]  14.01556        NA  26.61751 -33.65268

---

    Code
      rs$cyl$subsets
    Output
         mpg  disp drat    wt  qsec vs am gear carb
      1 10.4 360.0 4.11 3.845 17.05  1  0    5    4
      2 10.4 160.0 3.85 5.345 16.46  1  0    5    2
      3 21.0 146.7 3.54 2.140 17.42  1  1    5    1
      4 27.3 275.8 4.08 2.140 17.42  0  0    3    2
      5 26.0  95.1 3.70 2.200 17.98  1  1    5    4

---

    Code
      rs$cyl$ice_centered
    Output
      $`1`
       [1] -11.58584  40.44552 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
       [8] -26.50055 -11.58584  40.44552  40.44552 -11.58584  40.44552 -26.50055
      [15] -11.58584 -11.58584 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
      [22] -26.50055 -11.58584 -26.50055 -11.58584  40.44552 -26.50055 -11.58584
      [29]  40.44552 -11.58584  40.44552 -26.50055  40.44552  40.44552 -26.50055
      [36]  40.44552 -11.58584  40.44552 -11.58584 -26.50055 -11.58584 -26.50055
      [43] -11.58584 -11.58584 -11.58584 -11.58584 -26.50055 -11.58584  40.44552
      [50] -11.58584
      
      $`2`
       [1] -11.58584  40.44552 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
       [8] -26.50055 -11.58584  40.44552  40.44552 -11.58584  40.44552 -26.50055
      [15] -11.58584 -11.58584 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
      [22] -26.50055 -11.58584 -26.50055 -11.58584  40.44552 -26.50055 -11.58584
      [29]  40.44552 -11.58584  40.44552 -26.50055  40.44552  40.44552 -26.50055
      [36]  40.44552 -11.58584  40.44552 -11.58584 -26.50055 -11.58584 -26.50055
      [43] -11.58584 -11.58584 -11.58584 -11.58584 -26.50055 -11.58584  40.44552
      [50] -11.58584
      
      $`3`
       [1] -11.58584  40.44552 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
       [8] -26.50055 -11.58584  40.44552  40.44552 -11.58584  40.44552 -26.50055
      [15] -11.58584 -11.58584 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
      [22] -26.50055 -11.58584 -26.50055 -11.58584  40.44552 -26.50055 -11.58584
      [29]  40.44552 -11.58584  40.44552 -26.50055  40.44552  40.44552 -26.50055
      [36]  40.44552 -11.58584  40.44552 -11.58584 -26.50055 -11.58584 -26.50055
      [43] -11.58584 -11.58584 -11.58584 -11.58584 -26.50055 -11.58584  40.44552
      [50] -11.58584
      
      $`4`
       [1] -11.58584  40.44552 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
       [8] -26.50055 -11.58584  40.44552  40.44552 -11.58584  40.44552 -26.50055
      [15] -11.58584 -11.58584 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
      [22] -26.50055 -11.58584 -26.50055 -11.58584  40.44552 -26.50055 -11.58584
      [29]  40.44552 -11.58584  40.44552 -26.50055  40.44552  40.44552 -26.50055
      [36]  40.44552 -11.58584  40.44552 -11.58584 -26.50055 -11.58584 -26.50055
      [43] -11.58584 -11.58584 -11.58584 -11.58584 -26.50055 -11.58584  40.44552
      [50] -11.58584
      
      $`5`
       [1] -11.58584  40.44552 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
       [8] -26.50055 -11.58584  40.44552  40.44552 -11.58584  40.44552 -26.50055
      [15] -11.58584 -11.58584 -11.58584 -11.58584 -11.58584 -11.58584  40.44552
      [22] -26.50055 -11.58584 -26.50055 -11.58584  40.44552 -26.50055 -11.58584
      [29]  40.44552 -11.58584  40.44552 -26.50055  40.44552  40.44552 -26.50055
      [36]  40.44552 -11.58584  40.44552 -11.58584 -26.50055 -11.58584 -26.50055
      [43] -11.58584 -11.58584 -11.58584 -11.58584 -26.50055 -11.58584  40.44552
      [50] -11.58584
      

---

    Code
      rs$cyl$predict(c(4, NA, -5))
    Output
      [1] -11.58584   0.00000   0.00000

---

    Code
      predict(rs)
    Output
               1          2          3          4          5          6          7 
      199.999096 146.526014 168.568968 124.501296  99.529591  44.594945 118.744050 
               8          9         10         11         12         13         14 
       21.787353 225.585019 179.924798 223.318557  57.757142 257.673047  45.258033 
              15         16         17         18         19         20         21 
       56.954839 182.590196 156.678698 116.110006 146.975299   9.949657 122.248072 
              22         23         24         25         26         27         28 
       69.187080  29.539781  26.142013 177.283982 175.364418  99.391123 106.584150 
              29         30         31         32         33         34         35 
      216.886809  28.531047 162.396167  18.346122 243.902179  40.620141 279.823282 
              36         37         38         39         40         41         42 
      172.521215 159.185467 227.753685 217.685011 104.023133 104.157729 109.848797 
              43         44         45         46         47         48         49 
      155.415932 170.782893 205.793258 210.486048 232.992927 138.978181 203.118220 
              50 
      169.949257 

# sculpt_rough works with 1/2/3 variable(-s)

    Code
      rs$mpg$ice_centered
    Output
      $`1`
       [1]   11.037164  -87.855823   48.122034  -87.855823   54.302846   -4.856352
       [7]   88.738796  -60.483657   43.707168  -34.877437   63.132577  -20.749868
      [13]   63.132577  -34.877437   43.707168   88.738796  -34.877437  -49.005007
      [19]  -60.483657   35.760411  -87.855823 -118.759882  -34.877437 -105.515285
      [25]   48.122034   88.738796   20.749868   88.738796   43.707168  -49.005007
      [31]   -9.271218   -8.388244   23.398787   20.749868  -60.483657   46.356088
      [37]   -4.856352   -8.388244   20.749868   63.132577   23.398787  -34.877437
      [43]  -87.855823   50.770953  -49.005007   46.356088   -8.388244   11.037164
      [49]  -20.749868   27.813653
      

---

    Code
      rs$mpg$predict(c(15, NA, -5, 1e+05))
    Output
      [1]   48.12203         NA   88.73880 -118.75988

# sculpt_detailed_lm works as expected

    Code
      ds$mpg$predict(c(15, NA, -5, 1e+05))
    Output
      [1]      14.51416            NA      69.30524 -273899.79764

---

    Code
      ds$cyl$predict(factor(c("4", "6", "5")))
    Output
      [1] -24.51740 -39.43212   0.00000

# sculpt_detailed_gam works as expected

    Code
      ds$mpg$predict(c(15, NA, -5, 1e+05))
    Output
      [1]      11.29792            NA      66.08900 -273903.01388

---

    Code
      ds$cyl$predict(factor(c("4", "6", "5")))
    Output
      [1] -17.53130 -32.44602   0.00000

# sculptures work with missings flag - all same

    Code
      predict(rs, df)
    Output
              1         2         3         4         5         6         7         8 
      139.24316 111.40668  86.47959 121.67621 206.02694 123.50054 210.26953  86.52894 
              9        10        11        12        13        14        15        16 
       87.82898 120.07846 121.42838 204.78068 203.91288 205.93775 218.63767 218.14400 
             17        18        19        20        21        22        23        24 
      213.17503  76.01763  77.82266  74.25862  88.23088 207.38459 207.09790 210.82236 
             25        26        27        28        29        30        31        32 
      207.19042  80.94752  83.90009  78.62077 208.45293 118.66659 207.16732  88.36432 

---

    Code
      predict(ds, df)
    Output
              1         2         3         4         5         6         7         8 
      139.24316 111.40668  86.47959 121.67621 206.02694 123.50054 210.26953  86.52894 
              9        10        11        12        13        14        15        16 
       87.82898 120.07846 121.42838 204.78068 203.91288 205.93775 218.63767 218.14400 
             17        18        19        20        21        22        23        24 
      213.17503  76.01763  77.82266  74.25862  88.23088 207.38459 207.09790 210.82236 
             25        26        27        28        29        30        31        32 
      207.19042  80.94752  83.90009  78.62077 208.45293 118.66659 207.16732  88.36432 

---

    Code
      predict(ds, df)
    Output
              1         2         3         4         5         6         7         8 
      139.24316 111.40668  86.47959 121.67621 206.02694 123.50054 210.26953  86.52894 
              9        10        11        12        13        14        15        16 
       87.82898 120.07846 121.42838 204.78068 203.91288 205.93775 218.63767 218.14400 
             17        18        19        20        21        22        23        24 
      213.17503  76.01763  77.82266  74.25862  88.23088 207.38459 207.09790 210.82236 
             25        26        27        28        29        30        31        32 
      207.19042  80.94752  83.90009  78.62077 208.45293 118.66659 207.16732  88.36432 

# sculptures work with missings flag - different per column

    Code
      rs$mpg$predict(-1)
    Output
      [1] 36.68733

---

    Code
      predict(rs, df)
    Output
              1         2         3         4         5         6         7         8 
      147.73517 103.36850  91.85183 109.28517 194.82267 109.28517 233.27267  91.85183 
              9        10        11        12        13        14        15        16 
       91.85183 109.28517 109.28517 194.82267 194.82267 194.82267 233.27267 233.27267 
             17        18        19        20        21        22        23        24 
      233.27267  85.93517  85.93517  85.93517 108.03993 194.82267 194.82267 233.27267 
             25        26        27        28        29        30        31        32 
      194.82267  85.93517  91.85183  91.85183 194.82267 109.28517 233.27267 109.28517 

---

    Code
      predict(ds, df)
    Output
              1         2         3         4         5         6         7         8 
      156.23248 105.58628 102.50234 106.92644 199.38573 114.03067 209.23637  99.25306 
              9        10        11        12        13        14        15        16 
      102.78438 111.07444 114.20873 203.81091 201.79601 206.49745 218.93068 218.82749 
             17        18        19        20        21        22        23        24 
      209.02875  80.75809  85.20986  77.33457 105.51680 206.18868 206.73993 211.38916 
             25        26        27        28        29        30        31        32 
      198.61029  92.17846  95.44400  85.37667 205.80081 109.76071 207.16189 105.74842 

---

    Code
      ds$mpg$predict(-1)
    Output
      [1] 46.78158

---

    Code
      ds$mpg$predict(-1.1)
    Output
      [1] 47.00546

---

    Code
      predict(ds2, df)
    Output
              1         2         3         4         5         6         7         8 
      146.26275 102.79260 102.60796 107.06204 199.72992 114.54817 210.05434  99.15524 
              9        10        11        12        13        14        15        16 
      102.86359 111.51971 114.80475 204.47056 202.35875 207.28631 220.07841 219.98488 
             17        18        19        20        21        22        23        24 
      209.73924  79.85361  84.52315  76.27469 105.75266 206.91126 207.50609 212.32286 
             25        26        27        28        29        30        31        32 
      198.86843  91.82289  95.19516  84.67434 206.46451 110.17035 207.95200 105.99432 

---

    Code
      ds2$mpg$predict(-1)
    Output
      [1] 36.68733

---

    Code
      ds2$mpg$predict(-1.1)
    Output
      [1] 49.51817

