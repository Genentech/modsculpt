<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Direct and Indirect Additive Modeling with Model Sculpting
">
<title>{modsculpt} Model Sculpting â€¢ modsculpt</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="{modsculpt} Model Sculpting">
<meta property="og:description" content="Direct and Indirect Additive Modeling with Model Sculpting
">
<meta property="og:image" content="https://genentech.github.io/modsculpt/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">modsculpt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/modsculpt.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="articles/binary.html">Binary Example</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-reports">Reports</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-reports">
    <a class="dropdown-item" href="../unit-test-report/">Unit test report</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.github.com/genentech/modsculpt">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="modsculpt-">modsculpt <a class="anchor" aria-label="anchor" href="#modsculpt-"></a>
</h1>
</div>
<!-- start badges -->
<p><a href="https://genentech.github.io/modsculpt/unit-test-report/"><img src="https://github.com/genentech/modsculpt/actions/workflows/check.yaml/badge.svg" alt="Check ðŸ› "></a> <a href="https://genentech.github.io/modsculpt/"><img src="https://github.com/genentech/modsculpt/actions/workflows/docs.yaml/badge.svg" alt="Docs ðŸ“š"></a> <!-- end badges --></p>
<p><img src="reference/figures/ms_flow.png"></p>
<p>Additive modeling algorithms are an essential part of the machine learning modelerâ€™s tool kit when working with tabular data. Such predictive models have excellent intrinsic interpretability and often have optimal or near optimal performance. In some cases, the best additive model performance is attained by models that are linear functions of the input features. Such linear additive models can be fit using classical statistical models, when there are not too many features relative to the size of the training dataset, or regularized methods such as elastic net, when there are many features. However, there are also many cases where additive functions need to flexibly allow for:</p>
<ul>
<li>Non linearity for improved performance,</li>
<li>Imposing constraints on additive component functions for greater trustworthiness,</li>
<li>Handling of many features,</li>
<li>Identification of irrelevant or unnecessary features for model sparsity.</li>
</ul>
<p>To address this need we have developed the Model Sculpting method for building additive models. This is a model building pipeline consisting of the following steps:</p>
<ol style="list-style-type: decimal">
<li>Build a strong learner for optimal performance. This can be a blackbox that delivers optimal performance. Often we use a tree ensemble such as XGBoost trained with Bayesian hyperparameter tuning.</li>
<li>Extract an additive model that best approximates the strong learner. We call this the rough model.</li>
<li>Use a direct variable importance measure to identify features that have negligible impact on the rough model. Effectively we identify rough model additive components that are nearly flat.</li>
<li>Obtain a final polished model by removing the unnecessary features from the rough model and potentially smoothing the additive components for the remaining features. Any univariate smoother can be used, including those with facilities to ensure constraints such as monotonicity.</li>
</ol>
<p>This package provides code to implement the Model Sculpting pipeline.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"genentech/modsculpt"</span><span class="op">)</span></span></code></pre></div>
<p>For reproducibility, refer to a specific version tag (the latest is v0.1), for example</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="st">"genentech/modsculpt"</span>, ref <span class="op">=</span> <span class="st">"v0.1"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Please refer to <a href="https://genentech.github.io/modsculpt" class="uri">https://genentech.github.io/modsculpt</a> where you can see function reference as well as introduction vignette.</p>
</div>
<div class="section level2">
<h2 id="quick-introduction">Quick Introduction<a class="anchor" aria-label="anchor" href="#quick-introduction"></a>
</h2>
<p>Below we quickly show how to build a rough or a detailed model and visualize its components. For more detailed explanation, please see the vignette.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://genentech.github.io/modsculpt">modsculpt</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use mtcars dataset</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">vs</span><span class="op">)</span></span>
<span><span class="va">covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mpg"</span>, <span class="st">"carb"</span>, <span class="st">"vs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># train simple decision tree</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.html" class="external-link">rpart</a></span><span class="op">(</span></span>
<span>  <span class="va">hp</span> <span class="op">~</span> <span class="va">mpg</span> <span class="op">+</span> <span class="va">carb</span> <span class="op">+</span> <span class="va">vs</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df</span>,</span>
<span>  control <span class="op">=</span> <span class="fu">rpart</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rpart/man/rpart.control.html" class="external-link">rpart.control</a></span><span class="op">(</span>minsplit <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">model_predict</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">model</span>, newdata <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a rough model - extracted additive model from the decision tree</span></span>
<span><span class="va">pm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sample_marginals.html">sample_marginals</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">covariates</span><span class="op">]</span>, n <span class="op">=</span> <span class="fl">1e3</span>, seed <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">rs</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sculpt_rough.html">sculpt_rough</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">pm</span>,</span>
<span>  model_predict_fun <span class="op">=</span> <span class="va">model_predict</span>,</span>
<span>  n_ice <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># show variable importance</span></span>
<span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/grid.draw.html" class="external-link">grid.draw</a></span><span class="op">(</span><span class="fu"><a href="reference/g_var_imp.html">g_var_imp</a></span><span class="op">(</span><span class="va">rs</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p><img src="reference/figures/var_imp.png"></p>
<pre><code><span><span class="co"># create two detailed models - a smoothed version of a rough model</span></span>
<span><span class="va">dsg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sculpt_detailed_gam.html">sculpt_detailed_gam</a></span><span class="op">(</span><span class="va">rs</span><span class="op">)</span> <span class="co"># gam smoothers per variable</span></span>
<span><span class="va">dsl</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sculpt_detailed_lm.html">sculpt_detailed_lm</a></span><span class="op">(</span><span class="va">rs</span><span class="op">)</span>  <span class="co"># lm smoothers per variable</span></span>
<span></span>
<span><span class="co"># compare the components</span></span>
<span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/g_comparison.html">g_comparison</a></span><span class="op">(</span></span>
<span>  sculptures <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">rs</span>, <span class="va">dsg</span>, <span class="va">dsl</span><span class="op">)</span>,</span>
<span>  descriptions <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rough"</span>, <span class="st">"Detailed - gam"</span>, <span class="st">"Detailed - lm"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">comp</span><span class="op">$</span><span class="va">continuous</span></span></code></pre>
<p><img src="reference/figures/comparison.png"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>Apache License 2.0</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing modsculpt</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ondrej Slama <br><small class="roles"> Author, maintainer </small>  </li>
<li>Kenta Yoshida <br><small class="roles"> Author </small>  </li>
<li>Christina Rabe <br><small class="roles"> Author </small>  </li>
<li>Michel Friesenhahn <br><small class="roles"> Author </small>  </li>
<li>F. Hoffmann-La Roche AG <br><small class="roles"> Copyright holder, funder </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ondrej Slama, Kenta Yoshida, Christina Rabe, Michel Friesenhahn, F. Hoffmann-La Roche AG.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
